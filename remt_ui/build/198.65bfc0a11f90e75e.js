"use strict";(self.webpackChunkremt_ui=self.webpackChunkremt_ui||[]).push([[198],{8198:(E,A,c)=>{c.r(A),c.d(A,{CaretakerModule:()=>P});var g=c(6895),_=c(7392),q=c(8255),x=c(3803),C=c(4466),T=c(8252),U=c(7732),k=c(5266),t=c(4650),Z=c(1213),f=c(5496),y=c(5412),b=c(5004),w=c(9997);function I(o,a){if(1&o&&(t.TgZ(0,"div",3)(1,"div",8)(2,"h4",9),t._uU(3),t.ALo(4,"formatNames"),t.qZA(),t.TgZ(5,"div",10)(6,"div",11)(7,"h6",12)(8,"b"),t._uU(9,"House Details"),t.qZA()(),t.TgZ(10,"blockquote",13)(11,"b"),t._uU(12,"Ward:"),t.qZA(),t._uU(13),t.qZA(),t.TgZ(14,"blockquote",13)(15,"b"),t._uU(16,"Street:"),t.qZA(),t._uU(17),t.qZA(),t.TgZ(18,"blockquote",13)(19,"b"),t._uU(20,"Rooms:"),t.qZA(),t._uU(21),t.qZA(),t.TgZ(22,"blockquote",13)(23,"b"),t._uU(24,"Tenants Records:"),t.qZA(),t._uU(25),t.qZA(),t.TgZ(26,"blockquote",14)(27,"b"),t._uU(28,"Description:"),t.qZA(),t._uU(29),t.qZA()(),t._UZ(30,"hr"),t.TgZ(31,"div",11)(32,"h6",12)(33,"b"),t._uU(34,"Owner Details"),t.qZA()(),t.TgZ(35,"blockquote",13)(36,"b"),t._uU(37,"Owner:"),t.qZA(),t._uU(38),t.ALo(39,"formatNames"),t.qZA(),t.TgZ(40,"blockquote",13)(41,"b"),t._uU(42,"Gender:"),t.qZA(),t._uU(43),t.qZA(),t.TgZ(44,"blockquote",13)(45,"b"),t._uU(46,"Age:"),t.qZA(),t._uU(47),t.ALo(48,"userAge"),t.qZA(),t.TgZ(49,"blockquote",13)(50,"b"),t._uU(51,"phoneNumber:"),t.qZA(),t._uU(52),t.qZA(),t.TgZ(53,"blockquote",14)(54,"b"),t._uU(55,"Summary:"),t.qZA(),t._uU(56),t.qZA()()()()()),2&o){const n=a.$implicit;t.xp6(3),t.hij("",t.lcZ(4,11,n.type)," "),t.xp6(10),t.hij(" ",n.ward,""),t.xp6(4),t.hij(" ",n.street," "),t.xp6(4),t.hij(" ",n.rooms," "),t.xp6(4),t.hij(" ",null==n.rental_history?null:n.rental_history.length," "),t.xp6(4),t.hij(" ",n.description," "),t.xp6(9),t.hij(" ",t.lcZ(39,13,n.owner_Id.userInfos.name),""),t.xp6(5),t.hij(" ",n.owner_Id.userInfos.gender," "),t.xp6(4),t.hij(" ",t.lcZ(48,15,n.owner_Id.userInfos.age)," "),t.xp6(5),t.hij(" ",n.owner_Id.userInfos.phoneNumber," "),t.xp6(4),t.hij(" ",n.owner_Id.userInfos.summary," ")}}const j=function(){return[800,400]};let M=(()=>{var o;class a{constructor(s,l,p){this.userEntityService=s,this.storageService=l,this.dialog=p,this.estates=[],this.estatesGroup=[],this.subscription=this.userEntityService.entities$.pipe().subscribe({next:d=>{this.estates=d.filter(r=>"landlord"===r.userTypeName).map(r=>r.estates).reduce((r,e)=>r.concat(e),[]),this.estates=this.estates.filter(r=>r.caretakers?.find(e=>e===l.getId())),this.estates=this.estates.map(r=>{const e=d.find(i=>i._id==r.owner_Id);return{...r,owner_Id:e}}),this.estatesGroup=this.estates.reduce((r,e)=>{let u={name:e.type.toLowerCase(),value:0};if(!r.includes(r[r.findIndex(h=>h.name==e.type.toLowerCase())]))return u.value+=1,[...r,u];const m=r.find(h=>h.name==e.type.toLowerCase());return m?(m.value+=1,r.splice(r.findIndex(h=>h.name==m.name),1,m),[...r]):r},[])}})}ngOnDestroy(){console.log("ngOnDestroy from CaretakerHomeComponent"),this.subscription.unsubscribe()}ngOnInit(){}}return(o=a).\u0275fac=function(s){return new(s||o)(t.Y36(Z.W),t.Y36(f.V),t.Y36(y.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-caretaker-home"]],decls:11,vars:13,consts:[[1,"container-fluid"],[1,"row","pt-2"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"card-title","border-bottom"],[3,"view","results","xAxisLabel","legendTitle","yAxisLabel","legend","showXAxisLabel","showYAxisLabel","xAxis","yAxis","gradient"],["class","card",4,"ngFor","ngForOf"],[1,"card-body","row","border-success"],[1,"card-title","col-sm-3","align-middle"],[1,"card","col-sm-9"],[1,"card-body","row"],[1,"text-center","text-decoration-underline"],[1,"col-sm-6"],[1,"col-sm-12"]],template:function(s,l){1&s&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),t._uU(6,"House Types Summary Chart"),t.qZA(),t._UZ(7,"ngx-charts-bar-vertical",6),t.qZA()()()(),t.TgZ(8,"div",1)(9,"div",2),t.YNc(10,I,57,17,"div",7),t.qZA()()()),2&s&&(t.xp6(7),t.Q6J("view",t.DdM(12,j))("results",l.estatesGroup)("xAxisLabel","Type")("legendTitle","House Type Chart")("yAxisLabel","Amount")("legend",!0)("showXAxisLabel",!0)("showYAxisLabel",!0)("xAxis",!0)("yAxis",!0)("gradient",!0),t.xp6(3),t.Q6J("ngForOf",l.estates))},dependencies:[g.sg,x.K$,b.Q,w._]}),a})();var O=c(4407),L=c(323),v=c(8845);function H(o,a){if(1&o){const n=t.EpF();t.TgZ(0,"div",1)(1,"div",2)(2,"h5",3)(3,"h6")(4,"b")(5,"span"),t._uU(6),t.ALo(7,"formatNames"),t.qZA()(),t._UZ(8,"br"),t.TgZ(9,"span")(10,"small"),t._uU(11),t.qZA()()(),t.TgZ(12,"span"),t._UZ(13,"img",4),t.qZA()(),t.TgZ(14,"div",5)(15,"h6",6)(16,"b"),t._uU(17,"Rent Details"),t.qZA()(),t.TgZ(18,"blockquote",7)(19,"b"),t._uU(20,"House:"),t.qZA(),t._uU(21),t.qZA(),t.TgZ(22,"blockquote",7)(23,"b"),t._uU(24,"Rooms:"),t.qZA(),t._uU(25),t.qZA(),t.TgZ(26,"blockquote",7)(27,"b"),t._uU(28,"Start:"),t.qZA(),t._uU(29),t.ALo(30,"date"),t.qZA(),t.TgZ(31,"blockquote",7)(32,"b"),t._uU(33,"End:"),t.qZA(),t._uU(34),t.ALo(35,"date"),t.qZA(),t.TgZ(36,"blockquote",7)(37,"b"),t._uU(38,"Days Remaining:"),t.qZA(),t._uU(39),t.ALo(40,"daysRemain"),t.qZA(),t.TgZ(41,"blockquote",7)(42,"b"),t._uU(43,"Amount Paid:"),t.qZA(),t._uU(44),t.qZA()(),t.TgZ(45,"p",8)(46,"a",9),t.NdJ("click",function(){const p=t.CHM(n).$implicit,d=t.oxw();return t.KtG(d.editTenant(p,"update"))}),t._uU(47,"edit"),t.qZA(),t.TgZ(48,"a",10),t.NdJ("click",function(){const p=t.CHM(n).$implicit,d=t.oxw();return t.KtG(d.editTenant(p,"delete"))}),t._uU(49,"remove"),t.qZA()()()()}if(2&o){const n=a.$implicit;t.xp6(6),t.Oqu(t.lcZ(7,8,n.client.userInfos.name)),t.xp6(5),t.Oqu(n.client.userTypeName),t.xp6(10),t.hij(" ",n.house.type,""),t.xp6(4),t.hij(" ",n.rooms,""),t.xp6(4),t.hij(" ",t.lcZ(30,10,n.from),""),t.xp6(5),t.hij(" ",t.lcZ(35,12,n.to),""),t.xp6(5),t.hij(" ",t.lcZ(40,14,n),""),t.xp6(5),t.hij(" ",n.rent,"")}}const N=function(o){return{show:o}};function D(o,a){if(1&o&&(t.TgZ(0,"div",2)(1,"h2",3)(2,"button",4)(3,"p"),t._uU(4),t.ALo(5,"formatNames"),t.qZA()()(),t.TgZ(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"h5",9)(11,"h6")(12,"b")(13,"span"),t._uU(14),t.qZA()(),t._UZ(15,"br"),t.TgZ(16,"span")(17,"small"),t._uU(18),t.qZA()()(),t.TgZ(19,"span"),t._UZ(20,"img",10),t.qZA()(),t.TgZ(21,"div",11)(22,"h6",12)(23,"b"),t._uU(24,"Rent Details"),t.qZA()(),t.TgZ(25,"blockquote"),t._uU(26),t.ALo(27,"date"),t.qZA(),t.TgZ(28,"blockquote"),t._uU(29),t.ALo(30,"date"),t.qZA(),t.TgZ(31,"blockquote"),t._uU(32),t.ALo(33,"daysRemain"),t.qZA(),t.TgZ(34,"blockquote"),t._uU(35),t.qZA()()()()()()()),2&o){const n=a.$implicit,s=a.index;t.xp6(2),t.uIk("data-bs-target","#collapse"+s)("aria-controls","collapse"+s),t.xp6(2),t.Oqu(t.lcZ(5,11,n.client.userInfos.name)),t.xp6(2),t.Q6J("id","collapse"+s)("ngClass",t.VKq(19,N,0==s)),t.xp6(8),t.hij("userTypeName: ",n.client.userTypeName,""),t.xp6(4),t.hij(" phoneNumber: ",n.client.userInfos.phoneNumber," "),t.xp6(8),t.hij("Start: ",t.lcZ(27,13,n.from),""),t.xp6(3),t.hij("End: ",t.lcZ(30,15,n.to),""),t.xp6(3),t.hij(" Days Remaining: ",t.lcZ(33,17,n)," "),t.xp6(3),t.hij("Amount Paid: ",n.rent,"")}}const S=[{path:"",component:U.P,children:[{path:"manage_tenants",component:(()=>{var o;class a{constructor(s,l,p){this.userEntityService=s,this.storageService=l,this.dialog=p,this.estates=[],this.tenants=[],this.subscription=this.userEntityService.entities$.subscribe({next:d=>{this.estates=d.filter(e=>"landlord"===e.userTypeName).map(e=>e.estates).reduce((e,i)=>e.concat(i),[]),this.estates=this.estates.filter(e=>e.caretakers?.find(i=>i===this.storageService.getId()));let r=this.estates?.filter(e=>e.rental_history.length>0).map(e=>e.rental_history?.filter(u=>new Date(u.to).getTime()>Date.now())?.map(u=>({...u,house:e})));r=r?.reduce((e,i)=>e?.concat(i),[]),this.tenants=r?.map(e=>{const i=d.find(m=>m._id==e.client),u={...e};return u.client=i,u})}})}ngOnDestroy(){console.log("ngOnDestroy from MngTenantsComponent"),this.subscription.unsubscribe()}editTenant(s,l){this.dialog.open(L.W,{data:{history:s,estate:s.house,action:l}})}}return(o=a).\u0275fac=function(s){return new(s||o)(t.Y36(Z.W),t.Y36(f.V),t.Y36(y.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-mng-tenants"]],decls:1,vars:1,consts:[["class","card m-1",4,"ngFor","ngForOf"],[1,"card","m-1"],[1,"card-body"],[1,"card-title","d-flex","justify-content-between"],["src","../../../../assets/imgs/img6.jpg ","alt","",1,"userImg"],[1,"card-text","row","text-center"],[1,""],[1,"col-sm-6"],[1,"card-footer","text-center"],[1,"btn","text-black","bg-warning","mx-1",3,"click"],[1,"btn","text-black","bg-danger","mx-1",3,"click"]],template:function(s,l){1&s&&t.YNc(0,H,50,16,"div",0),2&s&&t.Q6J("ngForOf",l.tenants)},dependencies:[g.sg,g.uU,b.Q,v.I],styles:[".card-title[_ngcontent-%COMP%]   .userImg[_ngcontent-%COMP%]{height:45px;width:45px;border-radius:50%}"]}),a})()},{path:"view_rental_history",component:(()=>{var o;class a{constructor(s,l,p){this.userEntityService=s,this.storageService=l,this.dialog=p,this.estates=[],this.tenants=[],this.subscription=this.userEntityService.entities$.subscribe({next:d=>{this.estates=d.filter(e=>"landlord"===e.userTypeName).map(e=>e.estates).reduce((e,i)=>e.concat(i),[]),this.estates=this.estates.filter(e=>e.caretakers?.find(i=>i===l.getId()));let r=this.estates?.filter(e=>e.rental_history.length>0).map(e=>e.rental_history?.map(u=>({...u,house:e})));r=r?.reduce((e,i)=>e?.concat(i),[]),this.tenants=r?.sort((e,i)=>new Date(i.to).getTime()-new Date(e.to).getTime())?.map(e=>{const i=d.find(m=>m._id==e.client),u={...e};return u.client=i,u})}})}ngOnDestroy(){console.log("ngOnDestroy from tenantRentHistory"),this.subscription.unsubscribe()}}return(o=a).\u0275fac=function(s){return new(s||o)(t.Y36(Z.W),t.Y36(f.V),t.Y36(y.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-rental-history"]],decls:2,vars:1,consts:[["id","accordionTenant",1,"accordion","m-2"],["class","accordion-item",4,"ngFor","ngForOf"],[1,"accordion-item"],[1,"accordion-header"],["type","button","data-bs-toggle","collapse","aria-expanded","true",1,"accordion-button","d-flex","justify-content-between"],["data-bs-parent","#accordionTenant",1,"accordion-collapse","collapse",3,"id","ngClass"],[1,"accordion-body"],[1,"card"],[1,"card-body"],[1,"card-title","d-flex","justify-content-between"],["src","../../../../assets/imgs/img6.jpg","alt","",1,"userImg","float-lg-start"],[1,"card-text","text-center"],[1,""]],template:function(s,l){1&s&&(t.TgZ(0,"div",0),t.YNc(1,D,36,21,"div",1),t.qZA()),2&s&&(t.xp6(1),t.Q6J("ngForOf",l.tenants))},dependencies:[g.mk,g.sg,g.uU,b.Q,v.I],styles:[".card-title[_ngcontent-%COMP%]   .userImg[_ngcontent-%COMP%]{height:45px;width:45px;border-radius:50%}.accordion[_ngcontent-%COMP%], .accordion-item[_ngcontent-%COMP%], .accordion-header[_ngcontent-%COMP%], .accordion-button[_ngcontent-%COMP%], .accordion-body[_ngcontent-%COMP%]{background-color:#faad47!important;color:#000!important}"]}),a})()},{path:"create_invoices",component:O.I},{path:"",component:M},{path:"profile",component:k.d}]}];let Y=(()=>{var o;class a{}return(o=a).\u0275fac=function(s){return new(s||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[T.Bz.forChild(S),T.Bz]}),a})(),P=(()=>{var o;class a{}return(o=a).\u0275fac=function(s){return new(s||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[g.ez,x.a4,Y,C.m,q.Tx,_.Ps]}),a})()}}]);