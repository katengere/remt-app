"use strict";(self.webpackChunkremt_ui=self.webpackChunkremt_ui||[]).push([[74],{2538:(I,A,n)=>{n.d(A,{X:()=>E});var s=n(5412),p=n(5892),t=n(4650),e=n(9653),v=n(1213),i=n(6467),U=n(9201),O=n(5496),T=n(6895),h=n(4859),g=n(5004);function f(r,D){if(1&r){const _=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(_);const m=t.oxw();return t.KtG(m.deleteCaretaker())}),t._UZ(1,"i",9),t._uU(2,"Delete Caretaker "),t.qZA()}}function d(r,D){if(1&r){const _=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(_);const m=t.oxw();return t.KtG(m.deleteUser())}),t._UZ(1,"i",9),t._uU(2,"Delete User "),t.qZA()}}let E=(()=>{var r;class D{constructor(c,m,a,Z,l,u,o){this.dialogData=c,this.dialog=m,this.store=a,this.userEntityService=Z,this.houseEntityService=l,this.msg=u,this.storageService=o}deleteUser(){return this.userEntityService.delete(this.dialogData.data._id).subscribe({next:c=>{this.dialog.closeAll(),this.dialogData.data._id===this.storageService.getId()&&this.store.dispatch((0,p.kS)()),history.back(),this.msg.message({title:"Delete Success",text:"Successfully removed "+this.dialogData.data.userInfos.name,color:"green"})},error:c=>{this.msg.message({title:"Delete Failure",text:"Error "+c.message,color:"red"})}})}deleteCaretaker(){console.log("houseId ",this.dialogData.estate._id),console.log("caretakerId ",this.dialogData.caretakerId)}}return(r=D).\u0275fac=function(c){return new(c||r)(t.Y36(s.WI),t.Y36(s.uw),t.Y36(e.yh),t.Y36(v.W),t.Y36(i.k),t.Y36(U.e),t.Y36(O.V))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-confirm"]],decls:14,vars:7,consts:[["mat-dialog-title","",1,"card-title"],[1,"card-text"],[1,"card"],[1,"card-body"],["align","end",1,"card-footer"],["mat-raised-button","","mat-dialog-close","",1,"btn","btn-sm","m-1","close"],[1,"fa","fa-window-close"],["mat-raised-button","","mat-dialog-close","","class","btn btn-sm m-1 del",3,"click",4,"ngIf"],["mat-raised-button","","mat-dialog-close","",1,"btn","btn-sm","m-1","del",3,"click"],[1,"fa","fa-trash"]],template:function(c,m){1&c&&(t.TgZ(0,"h5",0),t._uU(1),t.qZA(),t.TgZ(2,"mat-dialog-content",1)(3,"div",2)(4,"div",3)(5,"p"),t._uU(6),t.ALo(7,"formatNames"),t.qZA()()()(),t.TgZ(8,"mat-dialog-actions",4)(9,"button",5),t._UZ(10,"i",6),t._uU(11,"Close "),t.qZA(),t.YNc(12,f,3,0,"button",7),t.YNc(13,d,3,0,"button",7),t.qZA()),2&c&&(t.xp6(1),t.AsE(" ",m.dialogData.action," ",m.dialogData.context,"\n"),t.xp6(5),t.hij(" Are you sure to delete ",t.lcZ(7,5,m.dialogData.name),"? "),t.xp6(6),t.Q6J("ngIf","Caretaker"==m.dialogData.context),t.xp6(1),t.Q6J("ngIf","User"==m.dialogData.context))},dependencies:[T.O5,s.ZT,s.uh,s.xY,s.H8,h.lW,g.Q],styles:["h5[_ngcontent-%COMP%], mat-dialog-content[_ngcontent-%COMP%], mat-dialog-actions[_ngcontent-%COMP%]{background-color:bisque;color:#000}mat-dialog-content[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]{color:#000}mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#deb887;color:#000}mat-dialog-actions[_ngcontent-%COMP%]   button.del[_ngcontent-%COMP%]:hover{background-color:#deb887;border:1px solid red;color:red}mat-dialog-actions[_ngcontent-%COMP%]   button.close[_ngcontent-%COMP%]:hover{background-color:#deb887;border:1px solid green;color:#fff}"]}),D})()},7842:(I,A,n)=>{n.d(A,{z:()=>p});var s=n(4650);let p=(()=>{var t;class e{transform(i){const[U,O]=i.split("/"),T=new Date(U).getTime(),h=new Date(O).getTime();if(h<Date.now())return"Done";const f=(h-T)/864e5;if(f%30==0)return Math.floor(f/30).toString();const d=f%30;return Math.floor(f/30).toString()+" and "+d+(d>1?" days":" day")}}return(t=e).\u0275fac=function(i){return new(i||t)},t.\u0275pipe=s.Yjl({name:"monthsDiff",type:t,pure:!0}),e})()},9997:(I,A,n)=>{n.d(A,{_:()=>p});var s=n(4650);let p=(()=>{var t;class e{transform(i){if("number"==typeof i||null==i)return i;const U=(new Date).getTime()-new Date(i).getTime();return Math.round(U/31536e6)}}return(t=e).\u0275fac=function(i){return new(i||t)},t.\u0275pipe=s.Yjl({name:"userAge",type:t,pure:!0}),e})()},5266:(I,A,n)=>{n.d(A,{d:()=>h});var s=n(4650),p=n(1213),t=n(5496),e=n(6895),v=n(2673),i=n(5004),U=n(9997),O=n(7842);function T(g,f){if(1&g&&(s.TgZ(0,"tr")(1,"td"),s._uU(2),s.ALo(3,"date"),s.qZA(),s.TgZ(4,"td"),s._uU(5),s.qZA(),s.TgZ(6,"td"),s._uU(7),s.qZA(),s.TgZ(8,"td"),s._uU(9),s.ALo(10,"monthsDiff"),s.qZA(),s.TgZ(11,"td"),s._uU(12),s.ALo(13,"number"),s.qZA(),s.TgZ(14,"td"),s._uU(15),s.ALo(16,"number"),s.qZA()()),2&g){const d=f.$implicit;s.xp6(2),s.Oqu(s.lcZ(3,6,d.createdAt)),s.xp6(3),s.Oqu(d.rooms),s.xp6(2),s.Oqu(d.rent),s.xp6(2),s.Oqu(s.lcZ(10,8,d.start+"/"+d.end)),s.xp6(3),s.Oqu(s.lcZ(13,10,d.rentTotal)),s.xp6(3),s.Oqu(s.lcZ(16,12,d.netTotal))}}let h=(()=>{var g;class f{constructor(E,r){this.userEntityService=E,this.storageService=r,this.invoices=[],this.subscription=this.userEntityService.entities$.pipe().subscribe({next:D=>{this.user=D.find(_=>_._id===this.storageService.getId()),this.invoices="landlord"==this.user?.userTypeName?this.user?.invoices:this.user?.invoices?.filter(_=>_.tenantId===this.user?._id),this.invoices=this.invoices?.reduce((_,c)=>_.includes(_[_.findIndex(m=>m.invoiceId==c.invoiceId)])?_:[..._,c],[])}})}ngOnDestroy(){console.log("ngOnDestroy"),this.subscription.unsubscribe()}}return(g=f).\u0275fac=function(E){return new(E||g)(s.Y36(p.W),s.Y36(t.V))},g.\u0275cmp=s.Xpm({type:g,selectors:[["app-profile"]],decls:89,vars:22,consts:[[1,"container-fluid","m-0","h-100","w-100"],[1,"row","m-2"],[1,"card","col-sm-6","flex-row",2,"background-color","rgb(112, 111, 111)"],["src","../../../assets//imgs//img7.jpg","width","75px","height","75px","alt",""],[1,"card","col-sm-6"],[1,"card","col-12"],[1,"mx-2"],[1,"card","m-0","p-0"],[1,"card-header","d-flex","justify-content-between"],["matBadgeOverlap","false","matBadgeColor","accent","matBadgeSize","small",3,"matBadge"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-bordered","border-dark"],["scope","col"],[1,"table-group-divider"],[4,"ngFor","ngForOf"],["type","button",1,"mx-2"],[1,"card-body","row"],[1,"col-sm-6"]],template:function(E,r){1&E&&(s.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div"),s._UZ(4,"img",3),s.qZA(),s._uU(5,"\xa0\xa0\xa0 "),s.TgZ(6,"div")(7,"h5")(8,"b"),s._uU(9,"Name: "),s.qZA(),s._uU(10),s.ALo(11,"formatNames"),s.qZA(),s.TgZ(12,"p")(13,"b"),s._uU(14,"Tel: "),s.qZA(),s._uU(15),s.qZA()()(),s.TgZ(16,"div",4)(17,"p")(18,"b"),s._uU(19,"Member Since: "),s.qZA(),s._uU(20),s.ALo(21,"date"),s.qZA(),s.TgZ(22,"p")(23,"b"),s._uU(24,"User Type: "),s.qZA(),s._uU(25),s.qZA()(),s.TgZ(26,"div",5)(27,"h6",6),s._uU(28),s.ALo(29,"formatNames"),s.qZA(),s.TgZ(30,"p"),s._uU(31),s.qZA()()(),s.TgZ(32,"div",1)(33,"div",7)(34,"div",8)(35,"h6",9),s._uU(36),s.qZA()(),s.TgZ(37,"div",10)(38,"div",11)(39,"table",12)(40,"thead")(41,"tr")(42,"th",13),s._uU(43,"Issued"),s.qZA(),s.TgZ(44,"th",13),s._uU(45,"Rooms"),s.qZA(),s.TgZ(46,"th",13),s._uU(47,"Rent"),s.qZA(),s.TgZ(48,"th",13),s._uU(49,"Duration "),s.TgZ(50,"small"),s._uU(51,"(months)"),s.qZA()(),s.TgZ(52,"th",13),s._uU(53,"Total"),s.qZA(),s.TgZ(54,"th",13),s._uU(55,"Net Total "),s.TgZ(56,"small"),s._uU(57,"[+ 7% tax]"),s.qZA()()()(),s.TgZ(58,"tbody",14),s.YNc(59,T,17,14,"tr",15),s.qZA()()()()()(),s.TgZ(60,"div",1)(61,"div",7)(62,"div",8)(63,"h6",6),s._uU(64,"Personal Information"),s.qZA(),s.TgZ(65,"button",16),s._uU(66,"edit"),s.qZA()(),s.TgZ(67,"div",17)(68,"p",18)(69,"b"),s._uU(70,"Name:"),s.qZA(),s._uU(71),s.qZA(),s.TgZ(72,"p",18)(73,"b"),s._uU(74,"Gender"),s.qZA(),s._uU(75),s.qZA(),s.TgZ(76,"p",18)(77,"b"),s._uU(78,"PhoneNumber: "),s.qZA(),s._uU(79),s.qZA(),s.TgZ(80,"p",18)(81,"b"),s._uU(82,"Age:"),s.qZA(),s._uU(83),s.ALo(84,"userAge"),s.qZA(),s.TgZ(85,"p",18)(86,"b"),s._uU(87,"Nation Id"),s.qZA(),s._uU(88),s.qZA()()()()()),2&E&&(s.xp6(10),s.Oqu(s.lcZ(11,14,null==r.user?null:r.user.userInfos.name)),s.xp6(5),s.Oqu(null==r.user?null:r.user.userInfos.phoneNumber),s.xp6(5),s.Oqu(s.lcZ(21,16,null==r.user?null:r.user.createdAt)),s.xp6(5),s.Oqu(null==r.user?null:r.user.userTypeName),s.xp6(3),s.hij("",s.lcZ(29,18,null==r.user?null:r.user.userTypeName)," Summary"),s.xp6(3),s.hij(" ",null==r.user||null==r.user.userInfos?null:r.user.userInfos.summary," "),s.xp6(4),s.Q6J("matBadge",null==r.invoices?null:r.invoices.length),s.xp6(1),s.hij("Invoices ","landlord"==(null==r.user?null:r.user.userTypeName)?"Created":"Received",""),s.xp6(23),s.Q6J("ngForOf",r.invoices),s.xp6(12),s.hij(" ",null==r.user||null==r.user.userInfos?null:r.user.userInfos.name,""),s.xp6(4),s.hij(" ",null==r.user||null==r.user.userInfos?null:r.user.userInfos.gender,""),s.xp6(4),s.hij(" ",null==r.user||null==r.user.userInfos?null:r.user.userInfos.phoneNumber,""),s.xp6(4),s.hij(" ",s.lcZ(84,20,null==r.user||null==r.user.userInfos?null:r.user.userInfos.age),""),s.xp6(5),s.hij(" ",null==r.user||null==r.user.userInfos?null:r.user.userInfos.nation_Id,""))},dependencies:[e.sg,v.k,e.JJ,e.uU,i.Q,U._,O.z],styles:["img[_ngcontent-%COMP%]{border-radius:50%}"]}),f})()},6467:(I,A,n)=>{n.d(A,{k:()=>v});var s=n(1656),p=n(4650),t=n(529),e=n(5496);let v=(()=>{var i;class U extends s.c8{constructor(T,h,g){super("House",T),this.http=h,this.storage=g}}return(i=U).\u0275fac=function(T){return new(T||i)(p.LFG(s.yV),p.LFG(t.eN),p.LFG(e.V))},i.\u0275prov=p.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),U})()},3476:(I,A,n)=>{n.d(A,{L:()=>m});var s=n(6129),p=n(6788),t=n(2538),e=n(4650),v=n(6180),i=n(1213),U=n(8252),O=n(5412),T=n(9201),h=n(6895),g=n(5004),f=n(9997);function d(a,Z){if(1&a&&(e.TgZ(0,"p",4),e._uU(1),e.qZA()),2&a){const l=Z.$implicit;e.xp6(1),e.hij(" ",l," ")}}function E(a,Z){if(1&a&&(e.TgZ(0,"div",4)(1,"p"),e._uU(2),e.qZA()()),2&a){const l=Z.$implicit;e.xp6(2),e.hij(" ",l.type," ")}}function r(a,Z){if(1&a&&(e.TgZ(0,"div",3)(1,"h5",8),e._uU(2),e.ALo(3,"formatNames"),e.qZA(),e.YNc(4,E,3,1,"div",9),e.qZA()),2&a){const l=e.oxw();e.xp6(2),e.hij(" Estates owned by ",e.lcZ(3,2,null==l.selectedUser||null==l.selectedUser.userInfos?null:l.selectedUser.userInfos.name)," "),e.xp6(2),e.Q6J("ngForOf",null==l.selectedUser?null:l.selectedUser.estates)}}function D(a,Z){if(1&a&&(e.TgZ(0,"div",3)(1,"h5",8),e._uU(2),e.ALo(3,"formatNames"),e.qZA(),e._UZ(4,"p",4),e.qZA()),2&a){const l=e.oxw();e.xp6(2),e.AsE(" Estates registered by ",null==l.selectedUser?null:l.selectedUser.userTypeName,": ",e.lcZ(3,2,null==l.selectedUser||null==l.selectedUser.userInfos?null:l.selectedUser.userInfos.name)," ")}}function _(a,Z){if(1&a&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.ALo(3,"formatNames"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.ALo(6,"formatNames"),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.ALo(9,"date"),e.qZA()()),2&a){const l=Z.$implicit;e.xp6(2),e.Oqu(e.lcZ(3,3,null==l||null==l.userInfos?null:l.userInfos.name)),e.xp6(3),e.Oqu(e.lcZ(6,5,null==l?null:l.userTypeName)),e.xp6(3),e.Oqu(e.lcZ(9,7,null==l?null:l.createdAt))}}function c(a,Z){if(1&a&&(e.TgZ(0,"div",3)(1,"h5",8),e._uU(2),e.ALo(3,"formatNames"),e.qZA(),e.TgZ(4,"div",4)(5,"table",16)(6,"thead")(7,"tr")(8,"th",7),e._uU(9,"Name"),e.qZA(),e.TgZ(10,"th",7),e._uU(11,"userTypeName"),e.qZA(),e.TgZ(12,"th",7),e._uU(13,"Registered"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,_,10,9,"tr",17),e.qZA()()()()),2&a){const l=e.oxw();e.xp6(2),e.lnq(" ",null==l.selectedUser?null:l.selectedUser.regUserIds.length," Users registered by ",null==l.selectedUser?null:l.selectedUser.userTypeName,": ",e.lcZ(3,4,null==l.selectedUser||null==l.selectedUser.userInfos?null:l.selectedUser.userInfos.name)," "),e.xp6(13),e.Q6J("ngForOf",null==l.selectedUser?null:l.selectedUser.regUserIds)}}let m=(()=>{var a;class Z{constructor(u,o,P,C,M,b){this.userDataService=u,this.userEntityService=o,this.activeRoute=P,this.route=C,this.dialog=M,this.msg=b,this.disabled=!1}ngOnInit(){this.activeRoute.params.pipe((0,s.z)(u=>this.userEntityService.getByKey(u.id))).subscribe({next:u=>{this.selectedUser=u,console.log(u),this.disabled="admin"==this.selectedUser.userTypeName.toLocaleLowerCase()||"lga"==this.selectedUser.userTypeName.toLocaleLowerCase()},error:u=>{this.msg.message({title:"Incorrect Credentials",text:u.message,color:"red"})}})}editUser(){this.dialog.open(p.y,{data:{user:this.selectedUser,action:"Edit User"}}).afterClosed().subscribe({next:u=>{console.log(u),this.ngOnInit()},error:u=>console.log(u)})}deleteUser(){this.dialog.open(t.X,{data:{name:this.selectedUser?.userInfos.name,context:"User",action:"Delete",data:this.selectedUser}})}}return(a=Z).\u0275fac=function(u){return new(u||a)(e.Y36(v.M),e.Y36(i.W),e.Y36(U.gz),e.Y36(U.F0),e.Y36(O.uw),e.Y36(T.e))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-user-details"]],decls:54,vars:19,consts:[[1,"card"],[1,"card-header","text-center"],["src","../../../../assets/imgs/img7.jpg","height","175px","width","175px","alt",""],[1,"card-body"],[1,"card-text"],[1,"table-responsive"],[1,"table"],["scope","col"],[1,"card-header","d-flex","justify-content-center"],["class","card-text",4,"ngFor","ngForOf"],["class","card-body",4,"ngIf"],[1,"card-footer","d-flex","justify-content-center"],[1,"btn","btn-warning","btn-sm","m-1",3,"click"],[1,"fa","fa-edit"],[1,"btn","btn-danger","btn-sm","m-1",3,"disabled","click"],[1,"fa","fa-trash"],[1,"table","caption-top"],[4,"ngFor","ngForOf"]],template:function(u,o){1&u&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"img",2)(3,"br"),e.TgZ(4,"h5")(5,"b"),e._uU(6),e.ALo(7,"formatNames"),e.qZA()(),e.TgZ(8,"p"),e._uU(9),e.qZA()(),e.TgZ(10,"div",3)(11,"div",4)(12,"div",5)(13,"table",6)(14,"thead")(15,"tr")(16,"th",7),e._uU(17,"Type"),e.qZA(),e.TgZ(18,"th",7),e._uU(19,"From"),e.qZA(),e.TgZ(20,"th",7),e._uU(21,"Age"),e.qZA(),e.TgZ(22,"th",7),e._uU(23,"Phone"),e.qZA(),e.TgZ(24,"th",7),e._uU(25,"NID"),e.qZA()()(),e.TgZ(26,"tbody")(27,"tr")(28,"td"),e._uU(29),e.qZA(),e.TgZ(30,"td"),e._uU(31),e.ALo(32,"date"),e.qZA(),e.TgZ(33,"td"),e._uU(34),e.ALo(35,"userAge"),e.qZA(),e.TgZ(36,"td"),e._uU(37),e.qZA(),e.TgZ(38,"td"),e._uU(39),e.qZA()()()()()()(),e.TgZ(40,"div",3)(41,"h5",8),e._uU(42),e.qZA(),e.YNc(43,d,2,1,"p",9),e.qZA(),e.YNc(44,r,5,4,"div",10),e.YNc(45,D,5,4,"div",10),e.YNc(46,c,16,6,"div",10),e.TgZ(47,"div",11)(48,"button",12),e.NdJ("click",function(){return o.editUser()}),e._UZ(49,"i",13),e._uU(50," Edit"),e.qZA(),e.TgZ(51,"button",14),e.NdJ("click",function(){return o.deleteUser()}),e._UZ(52,"i",15),e._uU(53," Delete "),e.qZA()()()),2&u&&(e.xp6(6),e.Oqu(e.lcZ(7,13,null==o.selectedUser||null==o.selectedUser.userInfos?null:o.selectedUser.userInfos.name)),e.xp6(3),e.Oqu(null==o.selectedUser||null==o.selectedUser.userInfos?null:o.selectedUser.userInfos.summary),e.xp6(20),e.Oqu(null==o.selectedUser?null:o.selectedUser.userTypeName),e.xp6(2),e.Oqu(e.lcZ(32,15,null==o.selectedUser?null:o.selectedUser.createdAt)),e.xp6(3),e.Oqu(e.lcZ(35,17,null==o.selectedUser||null==o.selectedUser.userInfos?null:o.selectedUser.userInfos.age)),e.xp6(3),e.Oqu(null==o.selectedUser||null==o.selectedUser.userInfos?null:o.selectedUser.userInfos.phoneNumber),e.xp6(2),e.Oqu(null==o.selectedUser||null==o.selectedUser.userInfos?null:o.selectedUser.userInfos.nation_Id),e.xp6(3),e.hij(" ",null==o.selectedUser?null:o.selectedUser.userTypeName," Permissions "),e.xp6(1),e.Q6J("ngForOf",null==o.selectedUser?null:o.selectedUser.permissions),e.xp6(1),e.Q6J("ngIf",(null==o.selectedUser?null:o.selectedUser.estates.length)>0),e.xp6(1),e.Q6J("ngIf",(null==o.selectedUser?null:o.selectedUser.regEstateIds.length)>0),e.xp6(1),e.Q6J("ngIf",(null==o.selectedUser?null:o.selectedUser.regUserIds.length)>0),e.xp6(5),e.Q6J("disabled",o.disabled))},dependencies:[h.sg,h.O5,h.uU,g.Q,f._],styles:["img[_ngcontent-%COMP%]{border-radius:50%}"]}),Z})()}}]);