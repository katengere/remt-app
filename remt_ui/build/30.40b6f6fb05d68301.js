"use strict";(self.webpackChunkremt_ui=self.webpackChunkremt_ui||[]).push([[30],{5030:(k,A,a)=>{a.r(A),a.d(A,{MainAdminModule:()=>V});var g=a(6895),x=a(3267),m=a(8252),T=a(6451),e=a(4650),h=a(1213),Z=a(887);const b=function(){return[800,400]},I=function(){return[800,300]};let _=(()=>{var t;class i{constructor(r){this.userEntityService=r,(0,T.T)(this.userEntityService.entities$,this.userEntityService.filteredEntities$).subscribe({next:s=>{this.estates=s.filter(o=>o.estates.length>1).reduce((o,l)=>null!==o?[...o,...l.estates]:[...o],[]).reduce((o,l)=>{let p={name:l.address.street.toLowerCase(),value:0};if(!o.includes(o[o.findIndex(u=>u.name.toLowerCase()==l.address.street.toLowerCase())]))return p.value+=1,[...o,p];const d=o.find(u=>u.name.toLowerCase()==l.address.street.toLowerCase());return d?(d.value+=1,o.splice(o.findIndex(u=>u.name.toLowerCase()==d.name.toLowerCase()),1,d),[...o]):o},[]),this.users=s.reduce((o,l)=>{let p={name:l.userTypeName.toLowerCase(),value:0};if(!o.includes(o[o.findIndex(u=>u.name.toLowerCase()==l.userTypeName.toLowerCase())]))return p.value+=1,[...o,p];const d=o.find(u=>u.name.toLowerCase()==l.userTypeName.toLowerCase());return d?(d.value+=1,o.splice(o.findIndex(u=>u.name.toLowerCase()==d.name.toLowerCase()),1,d),[...o]):o},[])}})}ngOnInit(){}}return(t=i).\u0275fac=function(r){return new(r||t)(e.Y36(h.W))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-main-admin-home"]],decls:14,vars:18,consts:[[1,"container-fluid"],[1,"row","pt-2"],[1,"col-12"],[1,"card","text-left"],[1,"card-body"],[1,"card-title","border-bottom"],[3,"view","results","xAxisLabel","legendTitle","yAxisLabel","legend","showXAxisLabel","showYAxisLabel","xAxis","yAxis","gradient"],[3,"results","legend","legendTitle","view","labels"]],template:function(r,s){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),e._uU(6,"User Types Summary Chart"),e.qZA(),e._UZ(7,"ngx-charts-bar-vertical",6),e.qZA()()(),e.TgZ(8,"div",2)(9,"div",3)(10,"div",4)(11,"h4",5),e._uU(12,"Houses per Street Chart"),e.qZA(),e._UZ(13,"ngx-charts-pie-chart",7),e.qZA()()()()()),2&r&&(e.xp6(7),e.Q6J("view",e.DdM(16,b))("results",s.users)("xAxisLabel","Users")("legendTitle","User Type Chart")("yAxisLabel","Amount")("legend",!0)("showXAxisLabel",!0)("showYAxisLabel",!0)("xAxis",!0)("yAxis",!0)("gradient",!0),e.xp6(6),e.Q6J("results",s.estates)("legend",!0)("legendTitle","Product Sale Report")("view",e.DdM(17,I))("labels",!0))},dependencies:[Z.K$,Z.JU]}),i})();var N=a(7732),v=a(5004);const L=function(t,i){return["/admin/",t,"manage_users",i]};function q(t,i){if(1&t&&(e.TgZ(0,"tr")(1,"td")(2,"div",6)(3,"a",7)(4,"div",8)(5,"h5",9),e._uU(6),e.ALo(7,"formatNames"),e.qZA(),e.TgZ(8,"small"),e._uU(9),e.qZA()(),e.TgZ(10,"p",9),e._uU(11,"Some placeholder content in a paragraph."),e.qZA(),e.TgZ(12,"small"),e._uU(13,"And some small print."),e.qZA()()()()()),2&t){const n=i.$implicit,r=e.oxw(2);e.xp6(3),e.Q6J("routerLink",e.WLB(5,L,r.paramId,n.id)),e.xp6(3),e.hij("Name: ",e.lcZ(7,3,n.userInfos.name),""),e.xp6(3),e.hij("Phone No: ",n.userInfos.phoneNumber,"")}}function w(t,i){if(1&t&&(e.ynx(0),e.TgZ(1,"tr")(2,"th",5),e._uU(3),e.qZA()(),e.YNc(4,q,14,8,"tr",4),e.BQk()),2&t){const n=i.$implicit;e.xp6(2),e.uIk("rowspan",n.users.length+1),e.xp6(1),e.Oqu(n.userTypeName),e.xp6(1),e.Q6J("ngForOf",n.users)}}let M=(()=>{var t;class i{constructor(r,s){this.userEntityService=r,this.route=s,(0,T.T)(this.userEntityService.entities$,this.userEntityService.filteredEntities$).subscribe({next:o=>{this.paramId=this.route.snapshot.parent?.params.id,this.users=o.reduce((l,c)=>{let d={userTypeName:c.userTypeName.toLowerCase(),users:[]};if(!l.includes(l[l.findIndex(U=>U.userTypeName.toLowerCase()==c.userTypeName.toLowerCase())]))return d.users.push(c),[...l,d];const u=l.find(U=>U.userTypeName.toLowerCase()==c.userTypeName.toLowerCase());return u?(u.users.push(c),l.splice(l.findIndex(U=>U.userTypeName.toLowerCase()==u.userTypeName.toLowerCase()),1,u),[...l]):l},[]),console.log(o)}})}}return(t=i).\u0275fac=function(r){return new(r||t)(e.Y36(h.W),e.Y36(m.gz))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-mng-users"]],decls:10,vars:1,consts:[[1,"table-responsive"],[1,"table"],["scope","col"],["scope","col",1,"text-center"],[4,"ngFor","ngForOf"],["scope","row"],[1,"list-group"],["routerLinkActive","active","aria-current","true",1,"list-group-item","list-group-item-action",3,"routerLink"],[1,"d-flex","w-100","justify-content-between"],[1,"mb-1"]],template:function(r,s){1&r&&(e.TgZ(0,"div",0)(1,"table",1)(2,"thead")(3,"tr")(4,"th",2),e._uU(5,"User Type"),e.qZA(),e.TgZ(6,"th",3),e._uU(7,"Details"),e.qZA()()(),e.TgZ(8,"tbody"),e.YNc(9,w,5,3,"ng-container",4),e.qZA()()()),2&r&&(e.xp6(9),e.Q6J("ngForOf",s.users))},dependencies:[g.sg,m.rH,m.Od,v.Q]}),i})();var E=a(6129),D=a(7225),f=a(5412),O=a(5233),Y=a(9653),y=a(9201),C=a(4859);function S(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.deleteUser(s.dialogData.data.id))}),e._UZ(1,"i",9),e._uU(2,"Delete "),e.qZA()}}let F=(()=>{var t;class i{constructor(r,s,o,l,c,p){this.dialogData=r,this.userEntityService=s,this.dialog=o,this.store=l,this.router=c,this.msg=p,this.store.select(O.gi).subscribe({next:d=>{const u=d.split("/");u.pop(),this.url=u.join("/")}})}deleteUser(r){this.userEntityService.delete(this.dialogData.data),this.dialog.closeAll(),this.userEntityService.getAll(),this.msg.message({title:"Delete Success",text:"Successfully removed "+this.dialogData.data.userInfos.name,color:"green"}),this.router.navigateByUrl(this.url)}}return(t=i).\u0275fac=function(r){return new(r||t)(e.Y36(f.WI),e.Y36(h.W),e.Y36(f.uw),e.Y36(Y.yh),e.Y36(m.F0),e.Y36(y.e))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-confirm"]],decls:13,vars:6,consts:[["mat-dialog-title","",1,"card-title"],[1,"card-text"],[1,"card"],[1,"card-body"],["align","end",1,"card-footer"],["mat-raised-button","","mat-dialog-close","",1,"btn","btn-sm","m-1"],[1,"fa","fa-window-close"],["mat-raised-button","","mat-dialog-close","","class","btn btn-sm bg-danger m-1",3,"click",4,"ngIf"],["mat-raised-button","","mat-dialog-close","",1,"btn","btn-sm","bg-danger","m-1",3,"click"],[1,"fa","fa-trash"]],template:function(r,s){1&r&&(e.TgZ(0,"h5",0),e._uU(1),e.qZA(),e.TgZ(2,"mat-dialog-content",1)(3,"div",2)(4,"div",3)(5,"p"),e._uU(6),e.ALo(7,"formatNames"),e.qZA()()()(),e.TgZ(8,"mat-dialog-actions",4)(9,"button",5),e._UZ(10,"i",6),e._uU(11,"Close "),e.qZA(),e.YNc(12,S,3,0,"button",7),e.qZA()),2&r&&(e.xp6(1),e.AsE(" ",s.dialogData.action," ",s.dialogData.context,"\n"),e.xp6(5),e.hij(" Are you sure to delete ",e.lcZ(7,4,s.dialogData.name),"? "),e.xp6(6),e.Q6J("ngIf","User"==s.dialogData.context))},dependencies:[g.O5,f.ZT,f.uh,f.xY,f.H8,C.lW,v.Q],styles:["h5[_ngcontent-%COMP%], mat-dialog-content[_ngcontent-%COMP%], mat-dialog-actions[_ngcontent-%COMP%]{background-color:#faad47!important;color:red!important}"]}),i})();function J(t,i){if(1&t&&(e.TgZ(0,"p",3),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.hij(" ",n," ")}}function Q(t,i){if(1&t&&(e.TgZ(0,"div",3)(1,"p"),e._uU(2),e.qZA()()),2&t){const n=i.$implicit;e.xp6(2),e.hij(" ",n.type," ")}}function $(t,i){if(1&t&&(e.TgZ(0,"div",1)(1,"h5",2),e._uU(2),e.ALo(3,"formatNames"),e.qZA(),e.YNc(4,Q,3,1,"div",7),e.qZA()),2&t){const n=e.oxw();e.xp6(2),e.hij(" Estates owned by ",e.lcZ(3,2,null==n.selectedUser||null==n.selectedUser.userInfos?null:n.selectedUser.userInfos.name)," "),e.xp6(2),e.Q6J("ngForOf",null==n.selectedUser?null:n.selectedUser.estates)}}function P(t,i){if(1&t&&(e.TgZ(0,"div",1)(1,"h5",2),e._uU(2),e.ALo(3,"formatNames"),e.qZA(),e._UZ(4,"p",3),e.qZA()),2&t){const n=e.oxw();e.xp6(2),e.AsE(" Estates registered by ",null==n.selectedUser?null:n.selectedUser.userTypeName,": ",e.lcZ(3,2,null==n.selectedUser||null==n.selectedUser.userInfos?null:n.selectedUser.userInfos.name)," ")}}function B(t,i){if(1&t&&(e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA()()),2&t){const n=i.$implicit,r=i.index;e.xp6(2),e.Oqu(r),e.xp6(2),e.Oqu(n.userInfos.name)}}function H(t,i){if(1&t&&(e.TgZ(0,"div",1)(1,"h5",2),e._uU(2),e.ALo(3,"formatNames"),e.qZA(),e.TgZ(4,"div",3)(5,"table",14)(6,"caption"),e._uU(7,"List of users"),e.qZA(),e.TgZ(8,"thead")(9,"tr")(10,"th",6),e._uU(11,"No"),e.qZA(),e.TgZ(12,"th",6),e._uU(13,"Name"),e.qZA()()(),e.TgZ(14,"tbody"),e.YNc(15,B,5,2,"tr",15),e.qZA()()()()),2&t){const n=e.oxw();e.xp6(2),e.AsE(" Users registered by ",null==n.selectedUser?null:n.selectedUser.userTypeName,": ",e.lcZ(3,3,null==n.selectedUser||null==n.selectedUser.userInfos?null:n.selectedUser.userInfos.name)," "),e.xp6(13),e.Q6J("ngForOf",n.regUserIds)}}const j=[{path:"",component:N.P,children:[{path:"",component:_},{path:"manage_users",component:M},{path:"manage_users/:id",component:(()=>{var t;class i{constructor(r,s,o,l,c){this.userEntityService=r,this.activeRoute=s,this.route=o,this.dialog=l,this.msg=c}ngOnInit(){this.activeRoute.params.pipe((0,E.z)(r=>this.userEntityService.getByKey(r.id))).subscribe({next:r=>{this.selectedUser=r,r.regUserIds?this.userEntityService.entities$.subscribe({next:s=>{this.regUserIds=r.regUserIds?.map(o=>s.find(l=>l.id==o))}}):r.regEstateIds&&this.userEntityService.entities$.subscribe({next:s=>{this.regEstateIds=r.regEstateIds?.map(o=>s.find(l=>l.id==o))}})},error:r=>{this.msg.message({title:"Incorrect Credentials",text:r.message,color:"red"})}})}editUser(){this.dialog.open(D.y,{data:{user:this.selectedUser,action:"Edit"}})}deleteUser(){this.dialog.open(F,{data:{name:this.selectedUser?.userInfos.name,context:"User",action:"Delete",data:this.selectedUser}})}}return(t=i).\u0275fac=function(r){return new(r||t)(e.Y36(h.W),e.Y36(m.gz),e.Y36(m.F0),e.Y36(f.uw),e.Y36(y.e))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-user-details"]],decls:54,vars:18,consts:[[1,"card"],[1,"card-body"],[1,"card-header","d-flex","justify-content-center"],[1,"card-text"],[1,"table-responsive"],[1,"table"],["scope","col"],["class","card-text",4,"ngFor","ngForOf"],["class","card-body",4,"ngIf"],[1,"card-footer","d-flex","justify-content-center"],[1,"btn","btn-warning","btn-sm","m-1",3,"click"],[1,"fa","fa-edit"],[1,"btn","btn-danger","btn-sm","m-1",3,"click"],[1,"fa","fa-trash"],[1,"table","caption-top"],[4,"ngFor","ngForOf"]],template:function(r,s){1&r&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"json"),e.qZA(),e.TgZ(3,"div",0)(4,"div",1)(5,"h5",2),e._uU(6," Personal Information "),e.qZA(),e.TgZ(7,"div",3)(8,"div",4)(9,"table",5)(10,"thead")(11,"tr")(12,"th",6),e._uU(13,"Name"),e.qZA(),e.TgZ(14,"th",6),e._uU(15,"Type"),e.qZA(),e.TgZ(16,"th",6),e._uU(17,"From"),e.qZA(),e.TgZ(18,"th",6),e._uU(19,"Age"),e.qZA(),e.TgZ(20,"th",6),e._uU(21,"Phone"),e.qZA(),e.TgZ(22,"th",6),e._uU(23,"id"),e.qZA()()(),e.TgZ(24,"tbody")(25,"tr")(26,"td"),e._uU(27),e.ALo(28,"formatNames"),e.qZA(),e.TgZ(29,"td"),e._uU(30),e.qZA(),e.TgZ(31,"td"),e._uU(32),e.ALo(33,"date"),e.qZA(),e.TgZ(34,"td"),e._uU(35),e.qZA(),e.TgZ(36,"td"),e._uU(37),e.qZA(),e.TgZ(38,"td"),e._uU(39),e.qZA()()()()()()(),e.TgZ(40,"div",1)(41,"h5",2),e._uU(42),e.qZA(),e.YNc(43,J,2,1,"p",7),e.qZA(),e.YNc(44,$,5,4,"div",8),e.YNc(45,P,5,4,"div",8),e.YNc(46,H,16,5,"div",8),e.TgZ(47,"div",9)(48,"button",10),e.NdJ("click",function(){return s.editUser()}),e._UZ(49,"i",11),e._uU(50," Edit"),e.qZA(),e.TgZ(51,"button",12),e.NdJ("click",function(){return s.deleteUser()}),e._UZ(52,"i",13),e._uU(53," Delete"),e.qZA()()()),2&r&&(e.xp6(1),e.Oqu(e.lcZ(2,12,s.selectedUser)),e.xp6(26),e.Oqu(e.lcZ(28,14,null==s.selectedUser||null==s.selectedUser.userInfos?null:s.selectedUser.userInfos.name)),e.xp6(3),e.Oqu(null==s.selectedUser?null:s.selectedUser.userTypeName),e.xp6(2),e.Oqu(e.lcZ(33,16,null==s.selectedUser?null:s.selectedUser.createdAt)),e.xp6(3),e.Oqu(null==s.selectedUser||null==s.selectedUser.userInfos?null:s.selectedUser.userInfos.age),e.xp6(2),e.Oqu(null==s.selectedUser||null==s.selectedUser.userInfos?null:s.selectedUser.userInfos.phoneNumber),e.xp6(2),e.Oqu(null==s.selectedUser||null==s.selectedUser.userInfos?null:s.selectedUser.userInfos.nationId),e.xp6(3),e.hij(" ",null==s.selectedUser?null:s.selectedUser.userTypeName," Permissions "),e.xp6(1),e.Q6J("ngForOf",null==s.selectedUser?null:s.selectedUser.permissions),e.xp6(1),e.Q6J("ngIf",(null==s.selectedUser?null:s.selectedUser.estates.length)>1),e.xp6(1),e.Q6J("ngIf",null==s.selectedUser?null:s.selectedUser.regEstateIds),e.xp6(1),e.Q6J("ngIf",null==s.selectedUser?null:s.selectedUser.regUserIds))},dependencies:[g.sg,g.O5,g.Ts,g.uU,v.Q]}),i})()}]}];let z=(()=>{var t;class i{}return(t=i).\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[m.Bz.forChild(j),m.Bz]}),i})();var R=a(7392),X=a(3683),K=a(4633),G=a(4466);let V=(()=>{var t;class i{}return(t=i).\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[g.ez,z,R.Ps,x.SJ,X.g0,C.ot,K.ie,G.m,Z.a4]}),i})()}}]);